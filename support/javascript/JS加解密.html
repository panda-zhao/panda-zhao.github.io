<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>JS加解密</title>
    <link rel="stylesheet" href="../../css/z-style.css" />
    <script src="../../js/crypto-js/crypto-js.js"></script>
    <script src="../../js/jsencrypt.min.js"></script>
    <script src="../../js/forge.min.js"></script>
  </head>

  <body>
    <div class="z-wrap-1200">
      <h2>base64加解密</h2>
      <div class="z-flex z-flex-between">
        <div class="z-mr-15">
          <p>加密前</p>
          <textarea
            id="a1"
            cols="60"
            rows="10"
            placeholder="要加密的文本"
          ></textarea>
          <div class="center">
            <button class="btn" onclick="enc_base64()">base64加密</button>
          </div>
        </div>
        <div>
          <p>加密后</p>
          <textarea
            id="a2"
            cols="60"
            rows="10"
            placeholder="加密后的文本"
          ></textarea>
          <div class="center">
            <button class="btn" onclick="dec_base64()">base64解密</button>
          </div>
        </div>
      </div>
      <hr />

      <h2>AES加解密</h2>
      <div class="z-form-item">
        <span class="z-form-item__label">请输入密钥（secretKey）</span>
        <div class="z-form-item__content">
          <input
            class="secretKey z-input"
            type="text"
            placeholder="请输入AES密钥"
            value="865CCAC4BC1FF58E21D626C5C932A41E388855E7FCF35FC18E7FDE9F7188522F"
          />
        </div>
      </div>
      <div class="z-flex z-flex-between">
        <div class="z-mr-15">
          <p>加密前</p>
          <textarea
            id="b1"
            cols="60"
            rows="10"
            placeholder="要加密的文本"
          ></textarea>
          <div class="center">
            <button class="btn" onclick="enc_AES()">AES加密</button>
          </div>
        </div>
        <div>
          <p>加密后</p>
          <textarea
            id="b2"
            cols="60"
            rows="10"
            placeholder="加密后的文本"
          ></textarea>
          <div class="center">
            <button class="btn" onclick="dec_AES()">AES解密</button>
          </div>
        </div>
      </div>
      <hr />

      <h2>MD5加密</h2>
      <div class="z-flex z-flex-between">
        <div class="z-mr-15">
          <p>加密前</p>
          <textarea
            id="c1"
            cols="60"
            rows="10"
            placeholder="要加密的文本"
          ></textarea>
        </div>
        <div>
          <p>加密后</p>
          <textarea
            id="c2"
            cols="60"
            rows="10"
            placeholder="加密后的文本"
          ></textarea>
        </div>
      </div>
      <div class="left">
        <button class="btn" onclick="enc_md5()">MD5加密</button>
        <button class="btn" onclick="enc_sha1()">SHA1加密</button>
        <button class="btn" onclick="enc_sha256()">SHA256加密</button>
        <button class="btn" onclick="enc_sha512()">SHA512加密</button>
        <button class="btn" onclick="enc_sha3(256)">Keccak-256加密</button>
        <button class="btn" onclick="enc_sha3(512)">Keccak-512加密</button>
      </div>
      <hr />

      <h2>RSA加解密</h2>
      <div class="z-flex z-flex-between">
        <div class="z-mr-15">
          <p>Private Key</p>
          <textarea id="privkey" cols="60" rows="10"></textarea>
        </div>
        <div>
          <p>Public Key</p>
          <textarea id="pubkey" cols="60" rows="10"></textarea>
        </div>
      </div>
      <div class="z-flex z-flex-between">
        <div class="z-mr-15">
          <p>加密前</p>
          <textarea
            id="d1"
            cols="60"
            rows="10"
            placeholder="要加密的文本"
          ></textarea>
          <div class="center">
            <button class="btn" onclick="enc_rsa_publickey()">公钥加密</button>
            <button class="btn" onclick="enc_rsa_privkey()">私钥加密</button>
          </div>
        </div>
        <div>
          <p>加密后</p>
          <textarea
            id="d2"
            cols="60"
            rows="10"
            placeholder="加密后的文本"
          ></textarea>
          <div class="center">
            <button class="btn" onclick="dec_rsa_publickey()">公钥解密</button>
            <button class="btn" onclick="dec_rsa_privkey()">私钥解密</button>
          </div>
        </div>
      </div>
      <hr />
    </div>

    <script>
      var key =
        '865CCAC4BC1FF58E21D626C5C932A41E388855E7FCF35FC18E7FDE9F7188522F'
      var iv = ''

      function encrypt(text) {
        return CryptoJS.AES.encrypt(text, CryptoJS.enc.Utf8.parse(key), {
          iv: CryptoJS.enc.Utf8.parse(iv),
          mode: CryptoJS.mode.CBC,
          padding: CryptoJS.pad.Pkcs7,
        })
      }

      function decrypt(text) {
        var result = CryptoJS.AES.decrypt(text, CryptoJS.enc.Utf8.parse(key), {
          iv: CryptoJS.enc.Utf8.parse(iv),
          mode: CryptoJS.mode.CBC,
          padding: CryptoJS.pad.Pkcs7,
        })
        return result.toString(CryptoJS.enc.Utf8)
      }

      var text = 'admin'
      var encoded = encrypt(text)
      console.log('加密', encoded.toString())
      console.log('解密', decrypt(encoded))

      // console.log('forge', forge)
      // base64加解密
      const enc_base64 = function () {
        const enc_str = document.querySelector('#a1').value
        try {
          document.querySelector('#a2').value = window.btoa(
            encodeURIComponent(enc_str),
          )
        } catch (error) {
          alert(error)
        }
      }
      const dec_base64 = function () {
        const dec_str = document.querySelector('#a2').value
        try {
          document.querySelector('#a1').value = decodeURIComponent(
            window.atob(dec_str),
          )
        } catch (error) {
          alert(error)
        }
      }
      const secretKey = document.querySelector('.secretKey').value // 密钥

      // 配置非必填
      const options = {
        mode: CryptoJS.mode.CBC, // 模式，CBC默认, CFB CTR OFB ECB
        padding: CryptoJS.pad.Pkcs7, // 填充方案，Pkcs7默认，Iso97971 AnsiX923 Iso10126 ZeroPadding NoPadding
      }

      // AES加解密
      const enc_AES = function () {
        const enc_str = document.querySelector('#b1').value
        console.log(enc_str)
        console.log(secretKey)
        try {
          const bytes = CryptoJS.AES.encrypt(enc_str, secretKey, options)
          console.log('AES加密后', bytes)
          document.querySelector('#b2').value = bytes.toString()
        } catch (error) {
          alert(error)
        }
      }

      const dec_AES = function () {
        const dec_str = document.querySelector('#b2').value
        try {
          const bytes = CryptoJS.AES.decrypt(dec_str, secretKey, options)
          console.log('AES解密后', bytes)
          document.querySelector('#b1').value = bytes.toString(
            CryptoJS.enc.Utf8,
          )
        } catch (error) {
          alert(error)
        }
      }

      // MD5加密
      const enc_md5 = function () {
        const enc_str = document.querySelector('#c1').value
        document.querySelector('#c2').value = CryptoJS.MD5(enc_str)
      }

      // SHA1加密
      const enc_sha1 = function () {
        const enc_str = document.querySelector('#c1').value
        document.querySelector('#c2').value = CryptoJS.SHA1(enc_str)
      }

      // SHA256加密
      const enc_sha256 = function () {
        const enc_str = document.querySelector('#c1').value
        document.querySelector('#c2').value = CryptoJS.SHA256(enc_str)
      }

      // SHA512加密
      const enc_sha512 = function () {
        const enc_str = document.querySelector('#c1').value
        document.querySelector('#c2').value = CryptoJS.SHA512(enc_str)
      }

      // SHA3加密
      const enc_sha3 = function (outputLength) {
        const enc_str = document.querySelector('#c1').value
        document.querySelector('#c2').value = CryptoJS.SHA3(enc_str, {
          outputLength: outputLength || 256, // 默认输出哈希长度
        })
      }

      // 公钥加密
      const enc_rsa_publickey = function () {
        const pubEncrypt = new JSEncrypt()
        const pubkey = document.querySelector('#pubkey').value
        console.log(pubEncrypt, pubkey)
        pubEncrypt.setPublicKey(pubkey)
        const startTime = new Date().getTime()
        const enc_str = document.querySelector('#d1').value
        const encrypted = pubEncrypt.encrypt(enc_str)
        const endTime = new Date().getTime() - startTime
        console.log('加密', endTime, encrypted)
        document.querySelector('#d2').value = encrypted
      }

      // 公钥解密
      const dec_rsa_publickey = function () {
        const pubEncrypt = new JSEncrypt()
        const pubkey = document.querySelector('#pubkey').value
        console.log(pubEncrypt, pubkey)
        pubEncrypt.setPublicKey(pubkey)
        const startTime = new Date().getTime()
        const dec_str = document.querySelector('#d2').value
        const decrypted = pubEncrypt.decrypt(dec_str)
        const endTime = new Date().getTime() - startTime
        console.log('解密后', endTime, decrypted)
        document.querySelector('#d1').value = pubEncrypt.decrypt(dec_str)
      }

      // 私钥加密
      const enc_rsa_privkey = function () {
        const priEncrypt = new JSEncrypt()
        const privkey = document.querySelector('#privkey').value
        console.log('privkey', privkey)
        priEncrypt.setPrivateKey(privkey)
        const startTime = new Date().getTime()
        const enc_str = document.querySelector('#d1').value
        const encrypted = priEncrypt.encrypt(enc_str)
        const endTime = new Date().getTime() - startTime
        console.log('加密后', endTime, encrypted)
        document.querySelector('#d2').value = encrypted
      }

      // 私钥解密
      const dec_rsa_privkey = function () {
        const priEncrypt = new JSEncrypt()
        const privkey = document.querySelector('#privkey').value
        console.log('privkey', privkey)
        priEncrypt.setPrivateKey(privkey)
        const startTime = new Date().getTime()
        const dec_str = document.querySelector('#d2').value
        const decrypted = priEncrypt.decrypt(dec_str)
        const endTime = new Date().getTime() - startTime
        console.log('解密后', endTime, decrypted)
        document.querySelector('#d1').value = decrypted
      }
    </script>
  </body>
</html>
